KKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK  
 DEV(186): DEV8  DEV8 I  TEM0  TEM1:"NMI PATCH.O",DEV,1 r  TEM1  TEM52000:"ASM.OBJ",DEV,1 (  I0  28: BYTE: 40966I,BYTE: 2 0,0,0,10,0,128,0,10,94,4,47,15,15,144 < 8,16,0,0,128,60,7,80,128,0,0,97,14,20,31 F TEM     :J?+`z{zLIL` , I`  *  hhL L|LI A.XL.O            BASIC HEADER            RESET.O            ASML.OBJ         1 KKKf`:f` +9< `+9 ` (  `  `    &     '   ` H  $:   
h8` l
  hhX $ '8   g0 gLs




&&f K > >e } ', ) ' `   -8ee
`    L T0"T3 T3 T; "D3D "D3D"D3"D3&1 !  YMJ,),#($y x$$  T RF&R!rBa2r,2K0KbHhS`S`2a22KK \0,10,0,128,0,10,94,4,47,15,15,144 M	P 8,16,0,0,128,60,7,80,128,0,0,97,14,20,31 V	Z TEM       SOURCEROR.O            LABELS.O             LABELER            	XREF.O             XREF.XL.O          KKKK _+8:   	I0
i	 `
HHf f`6VW \0A[E8 	$50@i]@,:l6 @Y
i$ `,		)    w I)L`gK0&p!psd0a0!FK|+	a``l
 jjj8$5p0 0A[E8 	$50@i]@,:l6 @Y
i$ `,		)    w I)L`gK7IL $5p
0
`
 
Jj)JJJJJ) :d)e)
JJJ	 
TbUc 
  yec&b* ' wexdG 'M 'LT0 d
  HJJJJ h)	0:i&L'K
UVVU V (<	#  (Lw	>	If_L# M>	^  ,)	 `,),-hh` a
UUV 2UVct$8LY 	 "H A6  ( 8 IN LINE:    A8fL hLw :L)$	>xU&V	0O >?O+ 	 ^ ()0) O) >:Lk=,ALT 	>x5>U>V6XV` 8<	(8 =VUVUf<	-HI'I8Vj<	Uh<	TQh% G$ XX;W f0e,,-`L 8  --eND ASSEMBLY,    2 8BYTES, eRRORS:   4 v )]@* 8 L E 8ALPHABET  8ICAL ORDER:   ) A  >? ^ A E 8NUMER LJ
 )x5M\fH,L x6$	 $_0)  ,: { / o$}LM`LT JeK` l8 V(-*$&  	$0 LG AL ]L 	I]HhGH ?>Gh91Jho7`x#|< Nj. d+e`Tk|,+%Z,!] ( lfh$lX$ ab} 8#+&2\hFI !p!rKK&`F8prBH h (&HRx@X,s  bR0(Pp >02,>	)_IYLO<	>/<Lo VU`]+)<	@A+`$0]X1H lhH0"X"' ;)_LW 
X"5'1,A;hXL.X/Y`U VUX VSXXS`i8:0Ly` x/? s>? >$5p L Q v " 9		  ,  DeFFEeGGF G  L)L  / L2W,P,O.L))#  )LY5`$"L) DE RF"L
J   #B,}DeFFEeGGCMBL lDEA .WK+./: %+ <	=	>	 	LwHL		`.	


J/	jfKjfK)JJ1	)_D0	)*KK /n + 	 
 3 J+<		( +'LHH `&<	j /L=i	 6XLyILwn<	>	 lVfW,,NLY-		 .O./JK p i B  P ` 9.8eO/i ,- 0@pP,`-L 59Lw  (8 y 8=$  K /U / yLcL[$('(),#%LLOl 0:*          LLbLLLLLLL'LLL1L Hr h  wp 'c hh Lbpaxys  '` '=L'7O!P3Z6L 8 oL2A
H)_[hE``<	+i<	` <	 j    j`<	"$5<	 +<	<	3 <	<	q >+LW<	 /, x



<	 xE p Lw1LYL #<	;  8gIVE VALUE FOR    8: >`*I0
#VVU<	I0
H
P  heU  9$	p8P  )-'.eUUeVV<			LW { T.*&THUTV	ThUHhVUL2PQ TFTjfVfUePHQeTTh`./<f o$0	>>?> ) )?>$
0 0
)x5>  =)ie =6X2
43
`x5` 8   sYMBOL TABLE -  `I@>)
) m 8 ]v$Pd 8 $0? {  q5>H6Xh`4?3>  )`doJII`h?> R>	>>>G> ^>?6$4> `i6,LZ ie>>?` a$=0UV`I0

i	 I` q(` UVJ&U&V<	2I0` V,UU<	0 aa0a2	a!L`02!F+AKS` LT  |dLBh  L"Lb  ) ,!.&+-/*E%e-,L  	$ ,	 	?;|  	 R0"LY ; .	  f-/,. }X" $0WN    	P` 	 q `      ,0+<	;	 q<	 W o L<<	 q+`$;0 FE`)  x  )If;` E%^`8 j1$,Ut$}%E$" ?L LL +9<	<	<	, n$=0U=	`)_	`LW8LBDMCEDeEe`bADOPCODADDRESS MODBRANCOPERANLABE"put"savINPUmEMORY FULuNKNOWN LABEnOT MACRnESTING ERROdUPLICATE SYMBObREA ,j'ApO! @!$ed +(H ayVUUgh \ +<	# A V;R)_A=	 E a1	I V$8Pd=	)_X>	I)V l	,LT el JS  V, Lw
( ('=	)_XY(  ULp0@L;, -   $^PL'LT-i -  ) l2LT !Af}0$}! AF} l$A0FGALw"  `,LY QH   ,LUQE.   y	 	  > fff0 ;sET/GETCURSORPOSITIONSTERsetlfs = $ffba ;sETLOGICALFILEsetnam = $ffbd ;sETFILENAMEopen = $ffc0close = $ffc3chkin = $ffc6 ;oPENCHANNELFORINPUTchkout = $ffc9 ;oPENCHANNELFOROUTPUTclrchn = $ffcc ;cLEARALLCHANNELSchrin = $ffcf ;g 8 & l  	)<		 l K] 3 ( K
$LW Lw?> U>V>`7/i,*%!H a h 8U 8 ALU0.U   lee$}UeLLeMMLwL K
9f$0-V,U   
*	 	  LZ b.$80b _ 8L1 b [( b`($8LV  	`;` Rb b`I 
b bL 	 # 	  )@,`0 0`$5P 	T 9   .94  r8  2L $5pL#    %1!A  , n   D .9I L08),0  .9   IAY2A!:JU?W `):I  W)1   )9*:7 `  ):(;Gstack = $100 ;mICROPROCESSORSTACKbuf = $200 ;iNPUTBUFFERlat = $259 ;aCTIVELOGICALFILESsat = $26d ;sECONDARYADDRESSESkeyd = $277 ;kEYBOARDQUEUEmemstr = $281 ;bOTTOMOFMEMORYmemsiz = $283 ;tOPOFMEMORYcolor = $286 ;cHARACTERCOLORgdcol =_ iIeyJz L    L `
  l.   n; fF8 	#):   *92  R  ';G  w &;  w  +L  + 9:      r 
 `+)30c ;a-REGISTERSAVEsxreg = $30d ;x-REGISTERSAVEsyreg = $30e ;y-REGISTERSAVEspreg = $30f ;sTATUS-REGISTERSAVEcinv = $314 ;irqVECTORcbinv = $316 ;brkVECTORnminv = $318 ;nmiVECTORiload = $330 ;loadVECTORisave = $332 ;saveVECTORborder = $d  XYh)X\	@]  X8 I `@L2 I0   L   /L;		RXL1:  RX  " ,); $ 8 ,L L; l;8Ll8() `pdnd~^~^~ lt  c_Q   )8frF 2 ;sECONDARYLISTENADDRESStksa = $ff96 ;sECONDARYTALKADDRESSmemtop = $ff99 ;sET/READTOPOFRAMacptr = $ffa5 ;gETBYTEFROMSERIALPORTciout = $ffa8 ;bYTETOSERIALPORTuntlk = $ffab ;uN-TALKunlsn = $ffae ;uN-LISTENlisten = $ffb1talk = $ffb4re++;   8>>e>e`asmaDD=usermonITORiNSERT@dELETEdrEPLACE4hiMEM:portnewtabscopytomovetolenGTHjlIST/.prINtErvalRc)_`[?p 6Z7[ #  A)_NIYa` N D '12  frL$r0L>stH
u$hLnyux
*eu  8uyevveww8fx z         , y
,0 3h ETBYTEFROMCHANNELchrout = $ffd2 ;bYTETOCHANNELload = $ffd5save = $ffd8settim = $ffdb ;sETSYSTEMCLOCKrdtim = $ffde ;rEADSYSTEMCLOCKstop = $ffe1 ;cHECKFORSTOPKEYgetin = $ffe4 ;gETBYTEFROMCHANNELclall = $ffe7 ;cLOSEALLFILESplot = $i >  H hl~  	)A[
HjhI `	 lRLR `2 , L /L1 / `L>-X.@/$5pT "!7iX\@]@ XLi8ff 5  8`$5,L> @H )   ? dV`bb	b	 T`))?	 D [./e- 8 DbT FV$VPW} . 	I*I@jI #$dH	bh!	`I `LFd0L	fd0
)b	 WEW)_8fV0*DRESSfa = $ba ;dEVICE#fnadr = $bb ;fILENAMEPOINTERndx = $c6 ;#cHRSINKEYBUFFERblnsw = $cc ;bLINKENABLEblnct = $cd ;bLINKCOUNTgdbln = $ce ;cHARACTERUNDERCURSORblnon = $cf ;bLINKONFLAGpntr = $d3 ;cURSORCOLUMNqtsw = $d4 ;qUOTEMODEFLAe$|0 :JD@  :2a:)> 		 0;	 0` ) ;0LD 	0		:	A]   A8fASfa `u  )IQ!  Q!J!:!BQ 	  [$a A .1  [ $ $287 ;bACKGROUNDCOLORATCURSORhibase = $288 ;tOPOFSCREENMEMORYxmax = $289 ;sIZEOFKEYBUFFERrptflg = $28a ;rEPEATALLKEYSIF$80shflag = $28d ;fLAGSSHIFT/CNTR/c=KEYSlstshf = $28e ;lASTSHIFTPATTERNimain = $302 ;basicWARMSTARTsareg = $$c s +) (6a+  67L3 q ?U?  (;)1)2`l;!1!||  ':17Z*   *:'  AY `  	  pq(67uyv_ w 020 ;bORDERCOLORbkgnd = $d021 ;bACKGROUNDCOLORregsave = $e147 ;rEGISTERSAVEROUTINEcint = $ff81 ;iNITSCREENEDITORrestor = $ff8a ;rESTORESYSTEMVECTORSvector = $ff8d ;sET/READSYSTEMVECTORSsetmsg = $ff90 ;mANAGEMESSAGEOUTPUTsecond = $ff93HANGEWffix fINDWpRINTerrORKeDITW'wHEREwtrUNContrUNCofFtextsymvidEO0-z_} !9 m ,    p "XS E2I;(	2$Q	S2(T2SS0	,2X \YH V	adst = $ffb7 ;rEADSTATUSREGISTERsetlfs = $ffba ;sETLOGICALFILEsetnam = $ffbd ;sETFILENAMEopen = $ffc0close = $ffc3chkin = $ffc6 ;oPENCHANNELFORINPUTchkout = $ffc9 ;oPENCHANNELFOROUTPUTclrchn = $ffcc ;cLEARALLCHANNELSchrin = $ffcf ;gtslp ===== pAGE   -   =====    ` `w vHJJJJ h)$x0	0xLLLLoLlL	uvu,0N q )L8 
 d ' NH "4339^(;Fh@ >`$50 `: eXTRA COMMAND CHARACTERS: fORMAT: oVERFLOW: mEMORY FULL: rANGEbYTESUSEDbYTESLEFTaLL OR SOME (a/s)?uPDATE SOURCE (y/n)?aSSEMBLING 	*;   ;"'  hh
*--------------------------------------*rOUTINETOCONVERTasciiSTRINGAT*ascstrTOATWOBYTEHEXNUMBERAT*num,num+1.uSEvarSTATEMENTTOSET*]1TO'F'OR'f'ACCORDINGTOWHICH*asciiSETISDESIRED.tHEROUTINE*IGNORESEXTRALEADINGD*--------------------------------------*basicHEADER.pUTTHISATTHESTART*OFAPROGRAMTOBEABLETO"run"IT.*-------------------------------------- org $801 da twobrk ;fIRSTLINK da 10 ;lINENUMBER10 dfb $9e ;sysTOKEN txt '2061' brk ; 6 	 
	LV          CONFIL.O            XREF A.O            XREF A.XL.O            BASIC HEADER            RESET.O                                           L  
  
^/  <P  aLjLLLLLh hh	 a 		HH``ML$501	 >1) 8 $5L> 0 0@)_` )$5
 8`H0)H, > 8hA)_[M    2 5  5bY gLEN bREDONc :cATALOGl :lOAD SOURCEs :sAVE SOURCEa :aPPEND FILEr :rEAD TEXT FILEw :wRITE TEXT FILEd :dRIVE CHANGEe :eNTER ed/asmo :sAVE OBJECT CODEg :rUN PROGRAMx :dISK COMMANDq :qUIT  5sOURCE: $  ,  1 
 TEM 6
 : "YOU MUST USE RELOCATOR 5.5 TO SET THE" b
  "PET EMULATION MODE OF 64 LINK.  THE" 
  "EMULATOR ITSELF SHOULD NOT BE USED."   EM1:"NMI PATCH.O",DEV,1 <  TEM1  TEM2:"LINK PATCH.O",DEV,1 F  TEM2  TEM3: 84096 	P  TE  H Oh (i*H Hl  8lOAD:  ` %7 W S    -@ T 8eDITOR L / Lh 8aPPEND:  L. C L )4Je >r > >L) o   >L L) 8sAVE:  `S F cR   0  H 	
0d <Lth)

00
 <$0D 8oUT OF MEMORY  8hIT A KEY  A Lh < 

W$` $7 LK 8wRITE FILE:  `W   
 

  
 <Lt   
l l LHJJJJ h)	0:i&L
#<>/*+-!.&;out of memory cROSS REFERENCED S ha  a 	D$K ApdNj. hlX+$k|8+&2\hF!p!rKK&FprB  &HR,suX(l !]abI    oHk Oe shift beq ]loop ;aLWAYSTAKENgothex rts ;xPOINTSTOCHRAFTERHEXSTRING--------------aschex lda #0 sta num+1 ;iNITnum tax ;ANDSTRINGPOINTER beq hx2 ;aLWAYSTAKEN]loop ora numhx2 sta num lda ascstr,x ;gETDIGIT cmp #'0' ;vALIDHEXDIGIIGITS,SOTHAT*'abcde'WILLCONVERTTO$bcde,ETC.*--------------------------------------aschex lda #0 sta num+1 ;iNITnum tax ;ANDSTRINGPOINTER beq hx2 ;aLWAYSTAKEN]loop ora numhx2 sta num lda ascstr,x ;gETDIGIT cmp #'0' ;vALIDHEXDIGI heNDOFBASICLINEtwobrk da 0 ;eNDOFBASICPROGRAM err *-2061*pUTMACHINELANGUAGEPROGRAMHERE:XY             KERNEL EQUATES         
    MULT/DIV             ASCHEX            KERNEL TABLE.S          ?J
(`H(`   7"hh l  `` ?`     ?` > /  ` , 8  i ?`uu  =!> e  e!!```0``0h
 ` j ?@(\ 50 !  > > >L> A`
 > & 		@`   	 >  a5a6a7E	%7  TN4 */H.H Oh.h/ G8,$  , 8dRIVE:   2 C)	 5oBJECT: $ FG , 8,$ FeDGeE , 8%  0)H6H``  L4JL [2  k,  . 6  >  )      BLN 8rUN:  O `5I`= >!`copyright 1983 glen bredon DQECWROSALXGF2J{| DJE iH` LV  L$DJE iH` LV~  f_ 12 #UW%7  $5]Fr8f| N :S 8FQ V T 	ql$   "= 8 l  L ,	S	, .			L V* 8dO YOU REALLY WANT TO EXIT?  Y O  8tO RE-ENTER merlin TYPE sys 52000	 L; C` 8oBJECT:  O FGBeDCeEB  L)Lt '41   8rEAD FILE:  M3  TEM52000:"ASML.OBJ",DEV,1 8	Z : I0  9: BYTE: _	d  I0  28: BYTE: 40966I,BYTE: 	n 72,138,72,152,72,169,127,141,13,221 	s :  CONFIGURATION DATA: 	x 0,0,0,10,0,128,0,10,94,4,47,15,15,144 	 8,16,0,0,128,60,7,80,128,0,0,97,14,20,3 <L   ` 8cOMMAND:  N ,    L L ) 8nEW DRIVE #: 8 &  5>67`                                   %=._hGq3K6z Gh h! L !H  )
JQ ?JJJH` !H- 8 N 2    A 	B	 9  a):	@
	`A	*	w| T4d?N# e 8R 8 8 L 8>xXxXx< a?+|`D&5+|B	,-\	|	 9)	B	\B	 	$;B	:	0	T? blt gothex ;eXITIFNOT eor #'0' cmp #10 ;nUMERICDIGIT? blt ix ;gOONIFSO adc #-]1!'0'-2 cmp #$fa ;vALIDHEXDIGIT? blt gothex ;eXITIFNOT eor #$f0 ;cONVERTTONIBBLEix inx ldy #4 ;iNDEXFORNIBBLESHIFTshift asl num rol num+1 dey bn
"" D""""D wD        www -  					####   	 z 	*L;H 
;:((LV bne nd ;OFFILEASASAFETY dec ql+1 ;MEASURE.nd dec ql lda #$d sta (ql),y jmp savpnt ;lETmERLINSAVETHEPOINTERSfret >>w w    D""D   "U" "  fUUDU"   f3U3  DDfUUf   "UDU"  3UU3   "UwD3  "w"""   3UU3f DDfUUU  " f""w   3U" DUfDfU  f""""w   Dwwww   DwUUU   "UUU"   fUUfDD  3UU3  fUDDD   3D"f  "w"""   UUUUw   UUUU"   UUUwU   UU"UU   UUUwf  w"Dw  fDDDDf  "UDfDw  
L
G@  (.
/LV,
0L5_6
77
6h6
7 :Jlmn`,
0 3HJ:JJI8eUhlih J:lJhi Uo$oP ei o)oo)
0IJ$o
Puoo                    wUDw w "UUwU w fUfUw w 3DDD3 w fUUUf w wDfDw w wDfDD w wDDUw w UUwUU w w"""w w Uw w UUfUU w DDDUw w        wUwwUU w wUUUw w wUwDD w "UUw3 w fUfUU w wD"w w w"""" w UUUUw w UUUU" w UUUwU w UU"UU w UU""" w w"Dw w fDDDf w D""" w f""" 2002               i o)oo)
0IJ$o
Puoo  
!.
/PLV k@67X
hiX
 s
 Jn





`$re G,` j
L
@67Z[`HJJJJ 
h)	0:i&- )k 
  
` # S,plh oIP 
  TEM0  60 @  I0  9: BYTE: BYTE(94096I) 150 f : 84096,0: (84096)0  150 ( DEV(186): DEV8  DEV8 2  TEM0  TEM1:"NMI PATCH.O",DEV,1 <  TEM1  TEM2:"LINK PATCH.O",DEV,1 F  TEM2  TEM3: 84096 	P  TE+<	0 	 2 T<	 
,L
H =  h) )=` >n?nnnninoo` 
* 
 /L,sNL
 G s
 j,pw 
NLj
$0,0P$j0p R8+&2\hF!p!rKK&FprB  &HR,suX(l !]abI)=` >n?nnnninoo` 
* 
 /L,sNL
 G s
 j,pw 
NLj
$0,0P$j0p W							w  UUwUUU  w""""w  U"  UfDfUU  DDDDUw  UwUUUU  UwwwwU  wUUUUw  fUUfDD  "UUUw3  fUUfUU  3D"f  w"""""  UUUUUw  UUUUU"  UUUUwU  UU""UU  UU""""  w""Dw  ""D"" """ " 
!.
/LV k@67
(hi 
  " 
 

 
 Jn





`  / L2H h LX.R.FILE,P,W$r} G,xIf   
    @&67Z[`2   f""""f  "w""""  "DD"   "D      "UUwUU  fUfUUf  wUDDUw  fUUUUf  wDfDDw  wDfDDD  wDDUUw  UUwUUU  w""""w  U"  UfDfUU  DDDDUw  UwUUUU  UwwwwU  wUUUUw  fUUfDD  "UUUw3  fUUfUU  3D"f  w"""""  UUUUUw  UUUUU"  UUUUwU  UU""UU  UU""""  w""Dw  ""D"" """ "
8:   
o N$o"p'  
, 
 2L
,
p0
n Em ElHJJJJ Nh)	0l~jk jJjKejjk`!p!rKK&FprB  &HR,sbR(02aa0a2	`02!F+KS`T|dh4f w "U    w     w w          """" "  UU      UUUU  "wf3w"  D""D  "U"fUw  ""      "DDDD"  D""""D  "w"w"   ""w""       ""D   w          "  ""DD  "UUUU"  "f"""w  "U"w  w"w  UUw  wDff  "DfUU"  wU  "U"UU"  wUw   "  "     " ""D "D"    .k ,  ,` #  ,plh oIP" no,J#+Kn,0

8 .	> ^)<	0 <	,-jjkkL$ 	0+<		(%'no,J#+Kn,0

.	> T^)<	0 <	,-jjkkL
 	0+<		(%'JK]8n<	;(n<	,0@<	 _$<	 FI0
i 	? 
` 3 
HNh:
`h`,L N	  000 )`N$
N~qpq 	s-		$fjlh kFj`  GVk@jlmno l>l?.lim 
H(`  
8ki  
l |
l |
L<#<>/*+-!.&;out of memory cROSS REFERENCED S ha  a 	D$K ApdNj. hlX+$k|JXK]Y8n<	;(n<	,0@<	 b)$<	 II0
i +<	0, <		  <	 
,L$H =  h) )=`>?ninooHk 
kh` ,4* , /L,sNL' Gj 
 j,pEw ,NL
$0,0P$j0p$fjlh kFj`  GVk@jlmno l>l?)lim ,`  ,8ki
 
!.
/ LV k@67
(hi 
  " 
 

 
 Jn





`  / L2H h LX.R.FILE,P,W$r} G,xIf   
    @B67Z[`2   	 W%1  	 	;> 	.G?1]';$0A[	  	* 	 	 	0	) 	( eL	  7 l`DBYPAGSKIENDMACMNDBYTWORddpaskenma<<dfd     !'*-"(+../L` 8fORMATTER HAS WRITTEN OVER THEASSEMBLER PORTION OF mERLIN.  rELOADmERLIN TO ASSEMBLE A FILE. Li# # 8rANGE TO FORMAT:  8 &L 8mEMORY L p %1   +4 	 8dO YOU WANT 2-SIDED JUSTIFICATION(y/n)?  	 yInN ':h8>  kd 			 )8&/!7 L%7 LJFw h$3 	\(9 o"Ww0 QHh,0
  
  ( `.!?h8>  kd 			 )8&/!7 L%7 LJFw h$3 	\(9 o"Ww0 
L
{.
/@
 ?LV`
_
~^
O~
`$80^
~_
L <>``@   
  
		 )?@67P\5]`   ),suX(l !]abI      ` +j* + /L,sNL& G 
 j,p{~ +NL
 'L
$0,0P$j0p$fjlh kFj`  GVk@jlmno l>l?)lim `N,N
l'O@@ W@LLm 
L @7J71T,)=  5, 3PN X@@N  LLN@  @! `NOninooH k 
kh` +j* + /L,sNL& G 
 j,p{~ +NL
 'L
$0,0P$j0p$fjlh kFj`  GVk@jlmno l>l?)lim RY L p %1    ':h8%12  
  "7 	k+12	,1+1]++2!?;)1";)2  8lINE WIDTH:   {fL  8sYNTAX  8 ERROR L  8rANGE L	 	D	 ;D	:.k +  +` #  ,plh oIP" no,J#+Kn,0

 .	> ^)<	0 <	,-jjkkL#+<		 	0 " 		I   +<	0+	+;  8oVERFLOW L  +4 	 8dO YOU WANT 2-SIDED JUSTIFICATION (y/n)?  N	I8 ':h8>  d 			 )8&0!7 L%7 LN h$3 	\(9   ':h8%12  k
  "7 	l+12	,2+1^,+2!@;)1";)2  8lINE WIDTH:  8 &fL  8sYNTAX  8 ERROR L  8rANGE L	 	D	 ;D	:	0+	+;  8oVERFLOW L  w ):	 	 		 L
*9  $<$I	    FvNIN 	I  	$N R   	 fv$0	  	   	$v$ 	  	$N RL` 8q#Y0p  ):	 	 	o3jog.r2
org/:r::{;fowz:? 
` 3 
HNh:
`h`,L N	  000 )`N$
N~qpq 	s-	$8 L}` 8Hh,0
  
  ( `.!?_ 8 `  # 8L>    	  8 NA[I  	 	 >@i@L8    	@I %`J@)

y` 

&
&i %`H Ph` W@  >L @ @ @ @ @ @ !"#%&'(*+,-/01245679:;<i' # N 8rANGE TO FORMAT:   {L 8mEMO+`  +8ki  
llH QlH. 
lh Qh* 
L)6 26`#<>/*+-!.&;out of memory cROSS REFERENCED S ha  a 	D$K ApdNj. hlX+$k|8+&2\hF!p!rKK&FprB  &HR v;vartab jmp linkset ;lETbasicFINISHITUPbadprog jmp (bascld) err *-1/$400 do savobj save "revive" fin fing;pl >>> addnum.4;pl ldy #0fndend lda (pl),y ;fINDENDOFFIRSTLINE php >>> incd.pl plp bne fndend >>> stind.pl;progbeg ;fIRSTL		(%'JK]8n<	;(n<	,0@<	 __$<	 FI0
i +<	0b 	  <	 
,L#H =  h) )=`)?>*------------------------*sELECTEDKERNELEQUATES*------------------------status = $90 ;i/oSTATUSWORDverck = $93 ;0=lOAD,1=vERIFYtime = $a0 ;rEALTIMECLOCK(3BYTES)fnlen = $b7 ;fILENAMELENGTHla = $b8 ;lOGICALFILE#sa = $b9 ;sECONDARYAD 
*********************macrolibrary****WITH2PROGRAM**EXAMPLES****2/20/83****uSEASAGUIDE*********************chrin = $ffcfchrout = ;]2+1 <<<trans mac >>> mov.]1;]2 >>> mov.]1+1;]2+1 <<<add mac clc lda ]1 adc ]2 sta ]3 lda ]1+1 adc ]2+1 sta ]3+1 <<<sub mac sec lda ]1 sbc ]2 sta ]3 lda ]1+1 sbc ]2+1 sta ]3+1 <<<addx mac txa clc adc ]1 sta ]2 lda ]1+1 <<<push mac lda ]1+1 pha lda ]1 pha <<<compare mac lda ]1 cmp ]2 lda ]1+1 sbc ]2+1 <<<cpradrs mac lda ]1 cmp #<]2 lda ]1+1 sbc #>]2 <<<poke mac >>> mov.#]2;]1 <<<setpnt mac >>> poke.]1;]2 >>> poke.]1+1;>]2 <<<cprstr maclpr chrout iny bne mlpsent <<<**********eXAMPLES************ exp off ;dONOTPRINTMACROEXPANSION tr on ;lIMITTO3BYTESPRINTED/LINEy = 1n = 0savobj kbd 'dOYOUWANTOBJECTCODESAVED?(Y/N)'example kbd 'aSSEMBLEWHICHPROGRAM?(1/2)' e*************** do example-1 elsepl = $8bql = $8dlen = $8fin = $200start = $800end = $d000imain = $302 org $334 lda #147 ;cLEAR&HOME jsr chrout >>> message.type >>> setpnt.pl;startinput0 ldx #0input jsr chrin and #%01111111 sta in> incd.ql >>> cpradrs.ql;end ;fINISHED? blt nxcmp >>> message.callexit jmp (imain)type txt 'TEXTTOLOCATE:' hex 0d brk ;sIGNALSMSGENDcall hex 0d txt 'SYS820FORMORE' hex 0d brk*sUBROUTINETOPRINTa,xINHEX:prntax jsr prbyte ;pRINT fin**********************************eXAMPLE2**(rEVIVEADEADbasicPROG.)**tOUSE:load"revive.o",8,1*THENsys820.tHEDEAD*PROGRAM,IFANY,WILLBEBACK.**pUTexample=2TOASSEMBLE********************************* do exampINKloop dey ;nOWy=0 >>> ldind.pl;ql ;pUTNEXTLINKINql lda ql ;iSLINK ora ql+1 ;=0? beq fixpnt >>> compare.ql;pl ;vALIDITYCHECK blt badprog >>> trans.ql;pl ;sETUPFORLOOP jmp loopfixpnt >>> addnum.2;pl ;nOWpl=ENDPROGRAM >>> trans.pl 
!.
/LV k@67W
hiW
 r
 Jn





`$rR G,M i
L
@67Z[`- )k 
  
` # h,plh oIP no,J#+Kn<	0 <		 3 U<	 
,L
H =  h) )=`nn)nn?n>nninoo` 
* 
 /L,sNL
 G r
 j,p~ 
NLi
 'L{
$$ffd2plot = $fff0incd mac inc ]1 bne nc inc ]1+1nc <<<decd mac lda ]1 bne nd dec ]1+1nd dec ]1 <<<mov mac lda ]1 sta ]2 <<<stind mac >>> mov.]1;(]2),y iny >>> mov.]1+1;(]2),y <<<ldind mac >>> mov.(]1),y;]2 iny >>> mov.(]1),yadc #0 sta ]2+1 <<<addy mac tya clc adc ]1 sta ]2 lda ]1+1 adc #0 sta ]2+1 <<<addnum mac lda #]1 clc adc ]2 sta ]2 bcc ni inc ]2+1ni <<<swap mac lda ]1 pha lda ]2 sta ]1 pla sta ]2 <<<pull mac pla sta ]1 pla sta ]1+1  lda (]2),y and #%01111111 cmp ]1,y bne out dey bpl lp inyout <<<prchr mac lda #]1 jsr chrout <<<pradrs mac ldx ]1 lda ]1+1 jsr prntax <<<gotoxy mac ldy #]1 ldx #]2 clc jsr plot <<<message mac ldy #0mlp lda ]1,y beq sent jsrr example-1/2**********************************eXAMPLE1**(fINDINPUTasciiSTRINGIN*MEMORYFROM$800TO$cfff.)**tOUSE:load"search.o",8,1*tYPEnewIFINDIRECTMODE*THENsys820**pUTexample=1TOASSEMBLE******************,x cmp #$d beq ingot inx cpx #$59 blt input bge input0ingot dex bmi exit ;lEAVEIFNOINPUT stx len >>> addx.pl;qlnxcmp ldy len >>> cprstr.in;pl bne next >>> prchr.$d ;fOUND,PRINTLOCATION >>> prchr.'$' >>> pradrs.plnext >>> incd.pl >>aINHEX txa ;gETxprbyte pha ;sUBROUTINETOPRINTaINHEX lup 4 lsr --^ jsr prnib ;pRINTHIGHNIBBLE pla ;gETLOWNIBBLE and #$fprnib ora #'0' cmp #'9'+1 blt prit adc #'A'-'9'-2prit jmp chrout err *-1/$400 do savobj save "search" finle-2 elsepl = $8bql = $8dprogbeg = $2bvartab = $2dlinkset = $a52abascld = $a000 org $334 >>> trans.progbeg;pl >>> addnum.4;pl ldy #0fndend lda (pl),y ;fINDENDOFFIRSTLINE php >>> incd.pl plp bne fndend >>> stind.pl;progbeg ;fIRSTL ERENCED S ha  a 	D$K ApdNj. hlX+$k|8+&2\hF!p!rKK&FprB  &HR,suX(l !]abI` 
* 
 /L,sNL
 G r
 j,p~ 
NLi
 'L{
$
,0

 .	> U^)<	0 <	,-jjkkL
+<		 	0 " 		I  3 U+<		(%'JK]8n<	;(n<	,0@<	 b$<	 II0
i +0,0P$j0p$fjlh kFj`  GVk@jlmno l>l?.lim 
H(`  
8ki  {
llH lH. {
lh h* {
LQ)6 26`#<>//*+-!.&;out of memory cROSS REFA \{                        l                            MERLIN          642A                                                                                      MERLIN            ASM.OBJ         1    NMI PATCH.O            SOURCEROR.O            LABELS.O             LABELER            	XREF.O             XREF.XL.O          KKSTRIP.O            FORMATTER.O            CHRGEN 80.O            KEYMAC.S            MACRO LIBRARY.S            PRINT            PRDEC            PRINTHEX          KK
INPUT             GETERR            READKEY            	GOTOXY             KERNEL EQUATES         
    MULT/DIV             ASCHEX            KERNEL TABLE.S          KKKERNEL.EQU            CYCLE TIMER.O            CONFIL.O            XREF A.O            XREF A.XL.O            BASIC HEADER            RESET.O            MERLIN.L          KK ASML.OBJ         1   LINK PATCH.O                                                                                                                                                                                                          KKKKK
G0?F E)` ,0ppPJ,P `@,M	`xHHH-) ) )  L) hhh@M L  
  
^/  <P  aLLLLLL hh	 a 		HH``ML$501	 >1) 8 $5L> 0 0@)_` )$5
 8`H0)H, > 8hA)_[M        1
    	 B L Lw0:LABELS.O bY gLEN bREDON   a HEX BYTE # AFTER COMMANDS T OR HLIMITS OUTPUT TO # BYTES.commands (ALONE OR AFTER HEX ADDRESS):L: dISASSEMBLET: tEXT.  (TT DEFEATS dci.)W: aDDRESS.  W-: ENT LOCATION OF THE PROGRAMTO BE DISASSEMBLED IS ITS ORIGINALLOCATION, HIT return.  iF NOT, GIVE LOCATION:  iN DISASSEMBLING, USE THE LOCATION.  pLEASE SPECIFY IT: pROCESSING dO YOU WANT AN OBJECT FILE LOADED?(y/n): oRIGINAL
  , $ 8ee   LLw %    oH()
h  LM! op f  s8LM '"w67   ; G  e).   )6
EFG0()dB/LtL?hLqLwL\ 1
 %L 5IIf# N?>H
)" h
0 " 
 "'' h
  
' ' 8(#e ) ()()L$#"f	 seLeMLC`HD&r'kd "RQ$dk?:"2"-) (     (hH h CDL ( (() (` 8L !  Hh)   !`   
7eHh0 i 




hG*+x4
* *+*#0 *) ( 
i
6X
  B   v  )_NJY  dci txt = $ 
 %
Jj)JJJJJ) Xd)e)
JJJ	 
rbsc 
  ec&b*  ede k `0 d
  HJJJJ h)	0:i&Le } , |+	a` ( jjj$0 0)A[E$ 	l6 L   -H 
  
h8`




&&fLy f  	I0
i` .)&  L#H	 ]*h8`h `HHHLe } , 	`               GETERR            READKEY            	GOTOXY             KERNEL EQUATES         
    MULT/DIV             ASCHEX            KERNEL TABLE.S           ffa5acptffc6chkiffc9chkouffcfchriffd2chrouffa8ciouff81cinffe7clalffc3closffccclrchffe4getifff3iobasff84ioiniffb1listeffd5loaff9cmemboff99memtoffc0opefff0ploff87ramtaffderdtiffb7readsff8arestoffd8savff9fscnkeffedscreeff93seconaDDRESS-1.  WW: ddbH: hEX DATA, 1 BYTE DEFAULT./: rETRIEVE LAST DEFAULT ADDRESS.I: iNSTRUCTIONS.Q: qUIT. d4"
iLLEGAL COMMAND; "I" FOR INSTRUCTIONS. lthwq hIT RETURN TO ACCEPT DEFAULT SOURCEADDRESS $2500, OR SPECIFY:  iF THE PRES LOCATION IS $ .uSE THIS FOR DISASSEMBLY.   `    JJ  
LL# Z` b667  )_YNL>  H 
&01   	h   
 	 B L() 7 bLq G &8  gHH 	If sNhh8I0iB/0&LEF8
JK
'h (aJK9  ()C(	( $
 Lgg G 	L,() (' d"
  '0  ` 	)L 5 dN)
  	 N8NJF  d

L|H 5hI dI-
i 
i    (
- 1 L oH8LMh` 0  0`
`
`()(`C"".  
Q#"
Q
h  Q
h


ja]Dh


   
 
    he


  
 
e. 	S 	 	    	      Lw7  O O	 l   o   LQ L) (`sAVE THIS SOURCE? (y/n): nAME OF FILE:   ddb  da  org  hex	  i)`  `8ee
` T0"T3 T3 T; "D3D "D3D"D3"D3&1 !  YMJ,),#($y x$$  T RF&R!rBa2r,2K0KbHhS`S`2a220&p!psd0a0!FK

 2061     ,  
  y   u  @  @_L	 W L 1 o   Lf Lh
h  

H
H`	$0  )L 
 d '`	` yhIT A KEYffbasetlfff90setmsffbdsetnaffdbsettiffa2settmffe1stoffb4talff96tksffeaudtiffaeunlsffabuntlff8dvecto0100stac0200bu0259la0263fa026dsa0277key0281memst0283memsi0285timou0286colo0287gdco0288hibas0289xma028arptfl028bkoun028cdela028d 14cin0316cbin0318nmin031aiope031ciclos031eichki0320ickou0322iclrc0324ibasi0326ibsou0328isto032aigeti032ciclal032eusrcm0330iloa0332isav033ctbuff0400vicsca000bascla002baswr olo0287gdco0288hibas0289xma028arptfl028bkoun028cdela028dD:  fLqL@lL5dLaD ,  yadd a label:gIVE VALUE IN HEX OF NEW LABEL: $  P%L	 ynOT A VALID HEX ADDRESS. L	0 @I0
i00I@5 ytHIS NUMBER IS ALREADY ASSIGNED A LABEL. L	 S LABEL IS ALREADY ASSIGNED. L	(  (0 0 D  @0 L	`  ,I0
.H

e
hehh yrANGE ERROR. L	hh ysYNTAX ERROR. L	 yddELETE WHICH LABEL(S)?   P`  SHh SL	 yffREE SPACE IN TABLE = $  8 6 y ( F  y) L	 ,  yhIT KEY "s" TO SAVE THIS VERSION OFlabels.o TO DISK.  hIT THE "stop" KEYTO ABORT PROGRAM.  &s   u @	 	 l  WL	  
***********************************keymac****eXAMPLESOFUSESOFmerlin'S**ADD-EDITKEYBOARDHOOKSAT**$7e-$7f.**vobj kbd 'dOYOUWANTOBJECTCODESAVED?(Y/N)'prognum kbd 'aSSEMBLEWHICHPROGRAM?(1-3)' err prognum-1/3invec = $7e ;eDITMODEKEYINPUTVECTOReflg = $38 ;mINUSWHENINEDITMODEusrcmd = $32e ;userVECTORstrings = $860 ;eDITORPUTSSTRINGHEREgSTUFFnowstart org $334**********************************eXAMPLE1(kEYBOARDMACROS)**wITH"\"LEADIN,PRINTSA**FOLLOWEDBY31COPIESOFCHR*TYPEDAFTEResc.iFTHISISA*SPACETHENANOTHER*ISPUTAT*THEEND.tHECURSORISTHENISE,GETKEY tay beq frstkey cmp #'\' ;lEADIN? beq nxk ;bRANCHIFSO ldy ysavret rts  ;rETURNWITHKEYIFNOTnxk jsr getin ;gETKEYAFTERLEADIN tay beq nxk ldy ysav bit ret ;cONTROLCHR? beq setstt ;aBORTIFSO sta charac ;sAVENEXTCHR  L  ,  ylabeler   tHIS PROGRAM ALLOWS REVISION ANDEXTENSION OF THE "sourceror" LABELTABLE.cOMMANDS:q: qUIT (REVISION COMPLETED)l: lIST LABELS NOW ASSIGNEDd: dELETE A LABEL OR LABELSa: aDD A LABELf: fREE SPACE LEFT   ycOMMANshfla028elstsh028fkeylo0291mod0292autod0293m51ct0297rssta0298bitnu0299baudo029bridb029cridb029drodb029erodb029firqtm02a1enab0300ierro0302imai0304icrnc0306iqplo0308igon030aieva030csare030dsxre030esyre030fspre0310usrpo0311usrad03lda #31 ;iNITCOUNT sta stateast lda #'*' ;sENDINITIAL* rtsnxstate lda charac ;gETCHR dec state ;cOUNTDOWN bne plus? ;lASTCOUNTIFEQUAL cmp #'' ;wASCHRASPACE? beq ast ;sUBSTITUE*FORLASTIFSO rtsplus? bpl back ;bRANCHIFNOTDONE l	 (0 ygIVE DESIRED LABEL:  PL	- ylABEL TOO LONG, MAX = 13 CHARACTERS. L	 0 : yiLLEGAL LABEL. L	 ie$ ylABEL MAKES TABLE TOO LONG. L	 Ve(0:) /() ytHI  (0	 (  L	 ,   ylist labelshIT A KEY TO START OR TO CONTINUE.uSE stop TO ABORT LISTING. L 1 E - n    = n H h 1   `  )@	  (`LL :HJJJJ Eh)	0:i&L  )@I  Y`  ` L@0:LABELS.ORT LISTING. L 1 E - n    = n H h 1 **gLENe.bREDON2/20/83**------------------------------**tOUSE:runDESIREDPROGRAM**FROMexec(g)THENINVOKE**WITHuserFROMEDITOR.********************************* tr exp offy = 1yes = 1n = 0no = 0saetin = $ffe4stadr mac lda #]1 sta ]2 lda #>]1 sta ]2+1 <<<**********************************cOMMONCODETOALLPARTS: org $900 >>> stadr.start;usrcmd ldy #$400-$334move lda nowstart-1,y sta start-1,y dey bne move rts ;eNDOFCOMMON	*PLACEDONTHEFIRSTCHARACTER.********************************* do prognum-1 elsestart >>> stadr.input;invecsetstt sec ror state ;iNITstate rtsinput bit state ;mACROINEFFECT? bpl nxstate ;bRANCHIFSO sty ysavfrstkey jsr getin ;oTHERW
<-rar cmp #'>' ;OR> bne docmd ;jUSTIGNORECNTRrIFNOT lda #$1d ;tRANSLATETO->docmd ldy ysav ;rETRIEVEyREG rts ;gIVEEDITORTHECHRysav brkindex brkautocmd brk err *-1/$3e0 ;mUSTENDBEFORE$3e0 do savobj save "autoedit" fin fin *-----------------------------------------*iNPUTROUTINE.gETSINPUTFROMCURRENT*INPUTDEVICE(USUALLYTHEKEYBOARD)AND*STORESITAT]2.iNPUTISTERMINATED*BYAcrANDCANBEATMOST]1CHARACTERS*LONG(256CHARACTERSIF]1=0).iFTHE*Uda #$9f&'b' ;pUTCURSORON1STCHRback rtsysav brkstate brkcharac brk do savobj save "repeat" fin fin*************************************eXAMPLE2(kEYBOARDMACROS)**kEYBOARDMACROSDEFINEDFORKEYS**>"'#+xyls-ocae*tate = $4a ;zEROPAGEUSEDTOxsav = $4b ;MAKEPROGRAMFITysav = $4c ;IN$344SPACEindex = $4d ;tHESEARENOTUSEDBYeDITORstart >>> stadr.input;invec sec ror state ;iNITstate rtsinput stx xsav ;mUSTPRESERVEx(&y) bit state ;IFUSED. b ora #$80 sta endtbl+1 ;INCASECMDNOTFOUND ldx #0 ;TOUSEFORITcmd? lda mactbl,x ;lOOKFORCOMMAND cmp endtbl ;mATCHINPUT? beq gotmac ;bRANCHIFSOgetchr inx  ;mOVETONEXTMAC lda mactbl,x bpl getchr ;lOOPTILLMINUS inx  ;pOINTTOCMDCLRHIGHBIT tax  ;iNCASEITISwndup-mactbl cmp #wndup-mactbl ;iSITWINDUPMAC? beq sxi ;bRANCHIFSOexit ldx xsav rtsgetkey sty ysavgk jsr getin tay beq gk ldy ysav rtsmactbl dci '>>>>' txt '2txt""' dfb $11,$9f&"i" ;bACKSPACE&I.$80 txt 'Ccmp' dfb wndup-mactbl.$80 txt 'Aand' dfb wndup-mactbl.$80 txt 'Eeor'wndup txt '(),y' hex 111111 ;bACKSPACETOBETWEEN() dfb $9f&"i" ;eXITININSERTMODEendtbl da 0 ;cOMMANDCHRPUTHERE err *-1/$400 do savobj save "keymac" ING"ISTHESEQUENCE*CONTROLo,CONTROLjTHEN*CONTROLjWILLBEINSERTEDATTHE*STARTOFEACHLINEOFTHEEDITRANGE.**cONTROLrFOLLOWEDBY>OR<GIVETHE*EFFECTDURINGTHEAUTOEDITOFTHE*CURSORKEYS->AND<-.************************ ;sKIPIFSO sta getkey+2 ;sAVEOLDINVECTOR lda invec sta getkey+1setvec >>> stadr.autoedit;invec rtsautoedit bit eflg ;fROMaDD/iNSERTOREDIT? bmi savy ;bRANCHIFFROMEDIT lda getkey+1 ;dISCONNECTOURSELVESIF sta invec ;FROMANaDDORiNS EXTLINE lda #$d ;eXITWITHcrisq cmp #'a'&$9f ;cONTROLa? bne leadin ldy #0 sty indexleadin cmp #'r'&$9f ;cONTROLrLEADIN? bne docmd ;bRANCHIFNOT inc index ;bUMPINDEX lda autocmd+1,y cmp #'<' ;nEXTCHRA< bne rar lda #$11 ;tRANSLATETO 	lst off lda #$d ;eXITWITHcrisq cmp #'a'&$9f ;cONTROLa? bne leadin ldy #0 sty indexleadin cmp #'r'&$9f ;cONTROLrLEADIN? bne docmd ;bRANCHIFNOT inc index ;bUMPINDEX lda autocmd+1,y cmp #'<' ;nEXTCHRA< bne rar lda #$11 ;tRANSLATETOSUALINPUTBUFFER$200ISUSEDFOR]2*THEN]1MUSTBEATMOST$58.*----------------------------------------- do ]2-$200 err ]1/$100 ;mUSTBEONEBYTE else ;iFUSINGUSUALINPUTBUFFER err ]1-1/$58 ;THENLENGTH<$59 fininput ldy #-1nxchr inyWITHTHESHIFTEDONESEQUIVALENT*TOTHEIRUNSHIFTEDCOUNTERPARTS.**mOSTOFTHESEAREVARIANTSOF*THEINDIRECT,INDEXEDBYy*OPCODES,EXITINGININSERTMODE*BETWEENTHEPARENTHESES.************************************ do prognum-2 elsespl getindex ;bRANCHIFDOINGMACROfrstkey jsr getkey ;oTHERWISE,GETKEY cmp #'\' ;"\"LEADIN? bne exit ;eXITIFNOTnxk jsr getkey ;gETKEYAFTERLEADIN cmp #'0' ;sHIFTCHR? bge noor ora #%00010000 ;sHIFTDOWNnoor sta endtbl ;sAVECURRENTINPUTBYTE bne cmd? ;aLWAYSTAKENgotmac inx  ;pOINTTOMACROSELECTEDsxi stx indexgetindex ldx index ;gETINDEXTOCURRENTCHR inc index ;pOINTTONEXTCHR lda mactbl,x ;gETCURRENTCHROFMACRO. sta state ;cLEARFLAGONLASTCHR and #$7f ;mUSTALWAYSNSERT txt :7txt'': dfb $11,$9f&"i" dci '3lda#' dci 'Xldx#' dci 'Yldy#' txt ';adc' dfb wndup-mactbl.$80 txt '=sbc' dfb wndup-mactbl.$80 txt 'Llda' dfb wndup-mactbl.$80 txt 'Ssta' dfb wndup-mactbl.$80 txt 'Oora' dfb wndup-mactblfin fin*******************************************eXAMPLE3(aUTO-EDIT)**user"STRING"ESTABLISHESANAUTO-EDIT*STRINGWHICHWILLBEEXECUTEDONEACH*LINEOFASUBSEQUENTeDIT.aNaDD/iNSERT*WILLDISCONNECTTHEROUTINE.**e.G.,IF"STR***************** do prognum-3 elsestart ldy #-1 ;mOVESTRINGSPECIFIEDnxb iny ;INuserCOMMAND lda strings,y sta autocmd,y ;(mAXLENGTH=$20) bne nxb sta index ;iNITINDEXTOCMD lda invec+1 ;iSITCONNECTEDNOW? cmp #>autoedit beq setvec	ERT lda getkey+2 sta invec+1getkey jmp $ffcf ;aDDRESSCHANGEDsavy sty ysav ;rEMEMBERy ldy index ;gETINDEXTONEXTCMDCHR inc index ;pOINTTONEXTONE lda autocmd,y ;gETNEXTCMDCHR bne isq ;bRANCHIFNOTLASTONE sta index ;iNITINDEXFORN
*-------------------------------------*rOUTINETOGETERRORMESSAGEFROM*CURRENTDISKDRIVE(DEVICE#ASSUMED*TOBEINfa)ANDPRINTITTOSCREEN.*-------------------------------------geterr jsr clrchn ;sETSTANDARDIN/OUTCHANNELS lda fa ;$ba  jsr chrin ;$ffcf sta ]2,y cmp #$d ;iNPUTDONE? do ]1 beq back ;eXITIFSO cpy #]1 ;lINETOOLONGFORBUFFER? blt nxchr ;lOOPIFNOT dey ;dISALLOWTHISCHR bge nxchr ;aLWAYSTAKEN else bne nxchr ;bRANCHIFNOTDONE finback rtsiFTHE*U*-----------------------------------------*sUBROUTINETOPRINTTHESTRINGFOLLOWING*THEjsrprint.tHESTRINGMUSTENDWITH*A0.pRIORTOAputOFTHISROUTINE,*AvarSTATEMENTMUSTBEUSEDTOSETUP*THEZEROPAGEPOINTER]1USEDANDALSO*T*-----------------------------------------*sUBROUTINETOPRINTa,xINDECIMAL.*uSESLOCATIONSnl,nh,nfl(SCRATCH)*ANDjust.(justSHOULDHOLD0FORLEFT,*OR$20FORRIGHTJUSTIFICATION.)*-----------------------------------------prdec sta nh sta nl iny ;cOUNTQUOTIENTDIGIT bne mkdec ;aLWAYSTAKENmkd2 tya ;gETQUOTIENTDIGIT dex ;pOINTTOSMALLERPOWEROF10 beq prdc ;pRINTDIGITIFLASTONE cmp #"0" ;pOSSIBLELEADINGZERO? beq mkd3 ;bRANCHIFSO sta nfl ;fLAGNUMBERSTARTEDmkd3 b*---------------------------------------*rOUTINETOPRINTa,xINHEX.eNTRYAT*prbyteCANALSOBEUSEDTOPRINTTHE*BYTEINaONLY,ORENTRYATprnibCAN*BEUSEDTOPRINTANIBBLE.*varMUSTBEUSEDTOSET]1TO0IF*uc/GRAPHICSCHARSETISU ALBYTEprnib and #$f ;mASKLOWNIBBLEphex ora #'0' cmp #'9'+1 ;dECIMALDIGIT? blt jco ;bRANCHIFSO adc #'A'-'9'-2+]1 ;aDDOFFSETFORHEXjco jmp chroutAN*BEUSEDTOPRINTANIBBLE.*varMUSTBEUSEDTOSET]1TO0IF*uc/GRAPHICSCHARSETISU*--------------------------------------*rOUTINETOGETAKEYFROMKEYBOARD*(ORINPUTDEVICE).iTFIRSTTURNSON*THECURSORANDTURNSITBACKOFFWHEN*CHARACTERHASBEENGATHERED.*cHARACTERISRETURNEDINa-REGISTER.*-------------------------- -EAVEITTHATWAY ldx xsav ;rETRIEVEx rtsUTINETOGETAKEYFROMKEYBOARD*(ORINPUTDEVICE).iTFIRSTTURNSON*THECURSORANDTURNSITBACKOFFWHEN*CHARACTERHASBEENGATHERED.*cHARACTERISRETURNEDINa-REGISTER.*--------------------------*---------------------------------------------*gotoxyROUTINETHATWILLWORKWITH80COLUMN*CARTRIDGEASWELLASWITHTHE40-COLUMN*SCREEN.eNTERWITH(x,y)=(VERT,HORIZ).*lEAVESa=$1d,x=0,y=$ffONEXIT.*---------------------------------------  jsr talk ;cOMMANDDEVICETOTALK lda #$6f ;cHANNEL15 sta sa ;$b9 jsr tksa lda #$d ;sETFORINITIALcrerrloop jsr chrout jsr acptr cmp #$d bne errloop jsr chrout ;dOcr jmp untlk ;ANDEXIT                                                      ;aLWAYSTAKENpchr jsr ]2 ;sENDTOOUTPUTROUTINEnxtchar ldy #0 incd ]1 ;pOINTTONEXTCHR lda (]1),y ;gETNEXTCHR bne pchr ;bRANCHIFNOTENDING0 push ]1 ;pUSHPOINTERTOSTACK;ANDRETURNTOINSTRUCTION rts ;FOLLOWINGTHESTRING.ANDALSO*THEOUTPUTROUTINEADDRESS]2(PERHAPS*chrout).**uSESTHEMACROSpull,pushANDincd*(SEETHEMACROLIBRARY).*-----------------------------------------print pull ]1 ;pULLCALLINGADDRESS;OFFSTACKANDUSE;FORZEROPAGEPOINTER. bne nxtchar  ;sTORENUMBERHI stx nl ;&LOW ldx #9 ;iNDEXFOR5DIGITS stx nflload0 ldy #"0" ;nUMERICOFFSETmkdec lda nl ;rEPEATEDSUBTRACTIONS cmp numtbl-1,x lda nh sbc numtbl,x bcc mkd2 ;bRANCHIFOVERFLOW sta nh ;dOTHESUBTRACT lda nl sbc numtbl-1,xit nfl ;wASADIGITPRINTED? bmi prdc ;pRINTTHISONEIFSO lda just ;lEADINGZERO,CHECKjust beq nxtx ;jUSTLEFT:SKIP;jUSTRIGHT:PRINTSPACEprdc and #$7f ;mASKHIGHBIT jsr chrout ;sENDDIGITnxtx dex ;pOINTTONEXTDIGIT bpl load0 ;lOOPTILLSEDORTO$20*IFlc/ucCHARSETISUSED.*---------------------------------------printhex jsr prbyte ;pRINTACC(2DIGITS) txa ;sETTOPRINTxprbyte pha ;sAVEACC lsr ;sHIFTHIGHNIBBLEDOWN lsr lsr lsr jsr phex ;pRINTIT pla ;rETRIEVEORIGIN *DONE rtsnumtbl da 1,10,100,1000,10000mkdec ;aLWAYSTAKENmkd2 tya ;gETQUOTIENTDIGIT dex ;pOINTTOSMALLERPOWEROF10 beq prdc ;pRINTDIGITIFLASTONE cmp #"0" ;pOSSIBLELEADINGZERO? beq mkd3 ;bRANCHIFSO sta nfl ;fLAGNUMBERSTARTEDmkd3 b------------readkey lda #0 sta blnsw ;tURNONCURSOR stx xsav ;pRESERVExrdkey jsr getin ;gETAKEY tax ;oNEAVAILABLE? beq rdkey ;lOOPIFNOT ldx #2 ;iNITSMALLBLINKCOUNT stx blnctwatbl ldx blnon ;wAITFORCURSOROFF bne watbl inc blnsw ;l ------gotoxy lda #19 ;hOMECURSORvo jsr chrout lda #17 ;cURSORDOWN dex bpl vo inx lda #29 ;cURSORRIGHT dey bpl vo rts                                                                                                                           
*-------------------------------------*16BITMULTIPLYANDDIVIDEROUTINES.*tHREE16BIT(TWO-BYTE)LOCATIONS*acc,auxANDextMUSTBESETUP,*PREFERABLYONZEROPAGE.*-------------------------------------*multiplyroutine*acc*aux->[acc, extdiv lda #0 sta ext+1 ldy #$10]loop asl acc rol acc+1 rol rol ext+1 pha cmp aux lda ext+1 sbc aux+1 bcc div2 sta ext+1 pla sbc aux pha inc accdiv2 pla dey bne ]loop sta ext rts------------*multiplyroutine*acc*aux->[acc,G  2 5  5bY gLEN bREDONc :cATALOGl :lOAD SOURCEs :sAVE SOURCEa :aPPEND FILEr :rEAD TEXT FILEw :wRITE TEXT FILEd :dRIVE CHANGEe :eNTER ed/asmo :sAVE OBJECT CODEg :rUN PROGRAMx :dISK COMMANDq :qUIT  5     BLa 8rUN:  O <01  H h (fH Hl  8lOAD:   %7 W S  <  -@ z 8eDITOR L / L 8aPPEND:  Lg i L ) o   >L L) 
*-------------------------------*sELECTEDKERNELEQUATES*(aSSEMBLES"kernel.equ"TABLE)*------------------------------- str 'status'9000 str 'time'a000 str 'la'b800 str 'sa'b900 str 'fa'ba00 str 'blnsw'cc00 str 'blnct'cd00 str 'blnon' '41   8rEAD FILE:  F R   0  WH 	
0d \Lh)

00
 \$0D 8oUT OF MEMORY  8hIT A KEY  A Lh \ 

W$` $7 L 8wRITE FILE:  W   $
 
'20d0 str 'bkgnd'21d0 str 'regsave'47e1 str 'cint'81ff str 'restor'8aff str 'vector'8dff str 'setmsg'90ff str 'second'93ff str 'tksa'96ff str 'memtop'99ff str 'acptr'a5ff str 'ciout'a8ff str 'untlk'abff str 'unlsn'aeff str 'listen'b1ff str C str 'stop'e1ff str 'getin'e4ff str 'clall'e7ff str 'plot'f0ffstor'8aff str 'vector'8dff str 'setmsg'90ff str 'second'93ff str 'tksa'96ff str 'memtop'99ff str 'acptr'a5ff str 'ciout'a8ff str 'untlk'abff str 'unlsn'aeff str 'listen'b1ff str status time la sa fa blnsw blnct blnon pntr qtsw stack buf memsizrptflgshflagimainsaregsxregsyregspregiload0isave2border bkgnd!regsaveGcintrestorvectorsetmsgsecondtksamemtop?J
(`H(`   7"hh l  `` ?`     ?` > /  ` , 8  i ?`uu  =!> e  e!!```0``ext](LOW,HI)32BITRESULTmult lda #0 sta ext+1 ldy #$11]loop lsr ext+1 ror ror acc+1 ror acc bcc mul2 clc adc aux pha lda aux+1 adc ext+1 sta ext+1 plamul2 dey bne ]loop sta ext rts*divideroutine*acc/aux->acc,REMAINDERIN0h
 `  ?@(\ 50, !  > > >L>L ?@\ A`
 > & 		@`   	 >  a5a6a7E	%7  zN4C23 sOURCE: $  , 8,$  , 8dRIVE:   2 i)	 5oBJECT: $ FG , 8,$ FeDGeE , 8%  0)H6H``  L   ~ JJ LL [E  ~,  . 6  >  )  8sAVE:  S <  $L ,	S	, .			L V 8dO YOU REALLY WANT TO EXIT?  Y   8tO RE-ENTER merlin TYPE sys 52000	 L; i` 8oBJECT:  O <FGBeDCeEB  $L)Lcf00 str 'pntr'd300 str 'qtsw'd400 str 'stack'0001 str 'buf'0002 str 'memsiz'8302 str 'rptflg'8a02 str 'shflag'8d02 str 'imain'0203 str 'sareg'0c03 str 'sxreg'0d03 str 'syreg'0e03 str 'spreg'0f03 str 'iload'3003 str 'isave'3203 str 'border	
  
 \L \L &  ` 8cOMMAND:  N O   $ L L ) 8nEW DRIVE #: 8 &  5>67`   %=._hGq3K6z Gh h! L !H  )
JQ ?JJJH` !H 'talk'b4ff str 'readst'b7ff str 'setlfs'baff str 'setnam'bdff str 'open'c0ff str 'close'c3ff str 'chkin'c6ff str 'chkout'c9ff str 'clrchn'ccff str 'chrin'cfff str 'chrout'd2ff str 'load'd5ff str 'save'd8ff str 'settim'dbff str 'rdtim'deff`5I`= >!`copyright 1983 glen bredon DQECWROSALXGfUO+ a        L$DJE iH` LV~  f_ 12 #UW%7  $5]Fr8f| N :S 8FQ V T 	ql$   "= 8 l acptrcioutuntlkunlsnlistentalkreadstsetlfssetnamopenclosechkinchkoutclrchnchrinchroutloadsavesettimrdtimstopgetinclallplot                                                            
_ iIeyJz L    L `
  l.   n; fF8 	#):   *92  R  ';G  w &;  w  +L  + 9:      r 
 `+)9   .94  r8  2L $5pL#    %1!A  , n   D .9I L08),0  .9   IAY2A!:JU?W `):I  W)1   )9*:7 `  ):(;*	 	  LZ b.$80b _ 8L1 b [( b`($8LV  	`;` Rb b`I 
b bL 	 # 	  )@,`0 0`$5P 	T h@ >`$50 `: eXTRA COMMAND CHARACTERS: fORMAT: oVERFLOW: mEMORY FULL: rANGEbYTESUSEDbYTESLEFTaLL OR SOME (a/s)?uPDATE SOURCE (y/n)?aSSEMBLING 	*;   ;"'  hhtslp ===== pAGE   -   =====    ` `w vHJJJJ h)$x0	0xLLLLoLlL	uvu,0N q )L8 
 d ' NH "4339^(;F +(H ayVUUgh \ +<	# A V;R)_A=	 E a1	I V$8Pd=	)_X>	I)V l	,LT el JS  V, Lw
( ('=	)_XY(  ULWN    	P` 	 q `      ,0+<	;	 q<	 W o L<<	 q+`$;0 FE`)  x  )If;` E%^`8 j1$,Ut$}%E$" ?L L- 8 N 2    A 	B	 9  a):	@
	`A	*	w| T4d?N# e 8R 8 8 L 8>xXxXx< a?+|`D&5+|B	,-\	|	 9)	B	\B	 	$;B	:	0HANGEWffix fINDWpRINTerrORKeDITW'wHEREwtrUNContrUNCofFtextsymvidEO0-z_} !9 m ,    p "XS E2I;(	2$Q	S2(T2SS0	,2X \YH V $c s +) (6a+  67L3 q ?U?  (;)1)2`l;!1!||  ':17Z*   *:'  AY `  	  pq(67uyv_ w e$|0 :JD@  :2a:)> 		 0;	 0` ) ;0LD 	0		:	A]   A8fASfa `u  )IQ!  Q!J!:!BQ 	  [$a A .1  [ $? dV`bb	b	 T`))?	 D [./e- 8 DbT FV$VPW} . 	I*I@jI #$dH	bh!	`I `LFd0L	fd0
)b	 WEW)_8fV0*i >  H hl~  	)A[
HjhI `	 lRLR `2 , L /L1 / `L>-X.@/$5pT "!7iX\@]@ XLi8ff 5  8`$5,L> @H )  )_`[?p 6Z7[ #  A)_NIYa` N D '12  frL$r0L>stH
u$hLnyux
*eu  8uyevveww8fx z         , y
,0 3h B,}DeFFEeGGCMBL lDEA .WK+./: %+ <	=	>	 	LwHL		`.	


J/	jfKjfK)JJ1	)_D0	)*KK /n + 	 
 3 J+<		( +'LHH `&<	j /L,>	)_IYLO<	>/<Lo VU`]+)<	@A+`$0]X1H lhH0"X"' ;)_LW 
X"5'1,A;hXL.X/Y`U VUX VSXXS`i8:0Ly` x/M\fH,L x6$	 $_0)  ,: { / o$}LM`LT JeK` l8 V(-*$&  	$0 LG AL ]L 	I]HhGH ?>Gh91Jho7`x++;   8>>e>e`asmaDD=usermonITORiNSERT@dELETEdrEPLACE4hiMEM:portnewtabscopytomovetolenGTHjlIST/.prINtErvalRc	  XYh)X\	@]  X8 I `@L2 I0   L   /L;		RXL1:  RX  " ,); $ 8 ,L L; l;8Ll8() `pdnd~^~^~ lt  c_Q   )8frF 2
UVVU V (<	#  (Lw	>	If_L# M>	^  ,)	 `,),-hh` a
UUV 2UVct$8LY 	 "H A6  ( 8 IN LINE:    A8fL hLw :L)$	> 8 & l  	)<		 l K] 3 ( K
$LW Lw?> U>V>`7/i,*%!H a h 8U 8 ALU0.U   lee$}UeLLeMMLwL K
9f$0-V,U   p0@L;, -   $^PL'LT-i -  ) l2LT !Af}0$}! AF} l$A0FGALw"  `,LY QH   ,LUQE.   y	 	  >L +9<	<	<	, n$=0U=	`)_	`LW8LBDMCEDeEe`bADOPCODADDRESS MODBRANCOPERANLABE"put"savINPUmEMORY FULuNKNOWN LABEnOT MACRnESTING ERROdUPLICATE SYMBObREA ,j'ApO! @!$edaa0a2	a!L`02!F+AKS` LT  |dLBh  L"Lb  ) ,!.&+-/*E%e-,L  	$ ,	 	?;|  	 R0"LY ; .	  f-/,. }X" $0>>?> ) )?>$
0 0
)x5>  =)ie =6X2
43
`x5` 8   sYMBOL TABLE -  `I@>)
) m 8 ]v$Pd 8 $0? {  qL7IL $5p
0
`
 
Jj)JJJJJ) :d)e)
JJJ	 
TbUc 
  yec&b* ' wexdG 'M 'LW0 d
  HJJJJ h)	0:i&L'5>H6Xh`4?3>  )`doJII`h?> R>	>>>G> ^>?6$4> `i6,LZ ie>>?` a$=0UV`I0

i	 I` q(` UVJ&U&V<	2I0` V,UU<	0  >`*I0
#VVU<	I0
H
P  heU  9$	p8P  )-'.eUUeVV<			LW { T.*&THUTV	ThUHhVUL2PQ TFTjfVfUePHQeTTh`./<f o$0 0&p!psd0a0!FK|+	a``l
 jjj8$5p0 0A[E8 	$50@i]@,:l6 @Y
i$ `,		)    w I)L`g 8 oL2A
H)_[hE``<	+i<	` <	 j    j`<	"$5<	 +<	<	3 <	<	q >+LW<	 /, x



<	 xE p Lw1LYL #<	;  8gIVE VALUE FOR    8:=i	 6XLyILwn<	>	 lVfW,,NLY-		 .O./JK p i B  P ` 9.8eO/i ,- 0@pP,`-L 59Lw  (? s>? >$5p L Q v " 9		  ,  DeFFEeGGF G  L)L  / L2W,P,O.L))#  )LY5`$"L) DE RF"L
J   ##|< Nj. d+e`Tk|,+%Z,!] ( lfh$lX$ ab} 8#+&2\hFI !p!rKK&`F8prBH h (&HRx@X,s  bR0(Pp >02XX;W f0e,,-`L 8  --eND ASSEMBLY,    2 8BYTES, eRRORS:   4 v )]@* 8 L E 8ALPHABET  8ICAL ORDER:   ) A  >? ^ A E 8NUMER LJ
 )x58 y 8=$  K /U / yLcL[$('(),#%LL I   $5 l LLbLLLLLLL'LLL1L Hr h  wp 'c hh Lbpaxys  '` '=L'7 6	 > >e } ', ) ' `   -8ee
` L T0"T3 T3 T; "D3D "D3D"D3"D3&1 !  YMJ,),#($y x$$  T RF&R!rBa2r,2K0KbHhS`S`2a22xU&V	0O >?O+ 	 ^ ()0) O) >:Lk=,ALT 	>x5>U>V6XV` 8<	(8 =VUVUf<	-HI'I8Vj<	Uh<	TQh% G$ 
f`:f` +9< `+9 ` (  `  `    &     '   ` H  $:   
h8` l
  hhX $ '8   g0 gLs




&&f KKKKKKKKK _+8:   	I0
i	 `
HHf f`6VW \0A[E8 	$50@i]@,:l6 @Y
i$ `,		)    w I)L`gKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK